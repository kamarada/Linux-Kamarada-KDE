<?xml version="1.0" encoding="UTF-8"?>
<manifest>
  <studio_uuid>8466bd24-fd59-11df-9f90-475ae2f5345b</studio_uuid>
  <appliance_uuid>de19ecc0-1d9f-11e7-9cb5-4fbb28ae4d82</appliance_uuid>
  <config>
    <image name="Linux_Kamarada_42.2_KDE" displayname="Linux_Kamarada_42.2_KDE" schemaversion="5.2">
      <description type="system">
        <author>Projeto Linux Kamarada</author>
        <contact>studio-devel@suse.de</contact>
        <specification>openSUSE Leap 42.1 KDE 4</specification>
      </description>
      <preferences>
        <type checkprebuilt="true" boot="isoboot/suse-leap42.1" fsnocheck="true" bootloader="grub2" firmware="uefi" flags="overlay" hybrid="true" image="iso">
          <split>
            <temporary>
              <file name="/var"/>
              <file name="/var/*"/>
              <file name="/etc"/>
              <file name="/etc/*"/>
              <file name="/tmp"/>
              <file name="/tmp/*"/>
              <file name="/home"/>
              <file name="/home/*"/>
            </temporary>
          </split>
        </type>
        <version>0.0.27</version>
        <packagemanager>ensconce</packagemanager>
        <rpm-check-signatures>false</rpm-check-signatures>
        <rpm-force>false</rpm-force>
        <boot-theme>studio</boot-theme>
        <timezone>UTC</timezone>
        <hwclock>localtime</hwclock>
        <locale>en_US</locale>
      </preferences>
      <users group="root">
        <user name="root" pwd="$1$cXqYzmQh$E5n.cUaza3WK9KwQchR7h." home="/root" shell="/bin/bash"/>
      </users>
      <repository type="yast2">
        <source path="http://download.opensuse.org/distribution/leap/42.2/repo/oss/"/>
      </repository>
      <repository type="rpm-md">
        <source path="http://download.opensuse.org/update/leap/42.2/oss/"/>
      </repository>
      <packages type="image" patternType="onlyRequired">
        <package name="vlc"/>
        <package name="phonon4qt5-backend-vlc"/>
        <package name="phonon-backend-vlc"/>
        <package name="kolourpaint"/>
        <package name="gparted"/>
        <package name="hplip"/>
        <package name="yakuake"/>
        <package name="joe"/>
        <package name="nano"/>
        <package name="libreoffice-kde4"/>
        <package name="yast2-branding-openSUSE"/>
        <package name="wallpaper-branding-openSUSE"/>
        <package name="systemd-presets-branding-openSUSE"/>
        <package name="sddm-branding-openSUSE"/>
        <package name="plymouth-branding-openSUSE"/>
        <package name="plasma5-workspace-branding-openSUSE"/>
        <package name="PackageKit-branding-openSUSE"/>
        <package name="NetworkManager-branding-openSUSE"/>
        <package name="MozillaFirefox-branding-openSUSE"/>
        <package name="libreoffice-branding-upstream"/>
        <package name="libpurple-branding-openSUSE"/>
        <package name="ksplashx-branding-openSUSE"/>
        <package name="ksplash-qml-branding-openSUSE"/>
        <package name="kdelibs4-branding-openSUSE"/>
        <package name="hicolor-icon-theme-branding-openSUSE"/>
        <package name="gtk3-branding-openSUSE"/>
        <package name="gio-branding-openSUSE"/>
        <package name="gconf2-branding-openSUSE"/>
        <package name="gtk2-branding-openSUSE"/>
        <package name="shim" bootinclude="true"/>
        <package name="grub2-x86_64-efi"/>
        <package name="xdg-utils"/>
        <package name="kde-cli-tools5"/>
        <package name="yast2-sudo"/>
        <package name="sudo"/>
        <package name="wpa_supplicant"/>
        <package name="wireless-regdb"/>
        <package name="pcmciautils"/>
        <package name="iw"/>
        <package name="crda"/>
        <package name="patterns-openSUSE-laptop"/>
        <package name="xf86-video-vmware"/>
        <package name="xf86-input-vmmouse"/>
        <package name="virtualbox-guest-x11"/>
        <package name="virtualbox-guest-tools"/>
        <package name="open-vm-tools-desktop"/>
        <package name="open-vm-tools"/>
        <package name="sweeper"/>
        <package name="spectacle"/>
        <package name="kwrite"/>
        <package name="kruler"/>
        <package name="kompare"/>
        <package name="knotes5"/>
        <package name="kmousetool"/>
        <package name="kmag"/>
        <package name="kleopatra5"/>
        <package name="kgpg"/>
        <package name="kcolorchooser"/>
        <package name="kcharselect"/>
        <package name="kcalc"/>
        <package name="xterm"/>
        <package name="system-config-printer"/>
        <package name="java-1_8_0-openjdk-headless"/>
        <package name="kwalletmanager5"/>
        <package name="ksysguard5"/>
        <package name="kget"/>
        <package name="yast2-packager"/>
        <package name="kinfocenter5"/>
        <package name="dolphin"/>
        <package name="ark"/>
        <package name="yast2"/>
        <package name="libqt4-x11"/>
        <package name="cups"/>
        <package name="java-1_8_0-openjdk-plugin"/>
        <package name="systemsettings5"/>
        <package name="okular"/>
        <package name="libreoffice-writer"/>
        <package name="libreoffice"/>
        <package name="libreoffice-impress"/>
        <package name="libreoffice-calc"/>
        <package name="libreoffice-base"/>
        <package name="korganizer5"/>
        <package name="kontact5"/>
        <package name="kaddressbook5"/>
        <package name="kscd"/>
        <package name="k3b"/>
        <package name="dragonplayer"/>
        <package name="amarok"/>
        <package name="kopete"/>
        <package name="konversation"/>
        <package name="konqueror"/>
        <package name="plasma5-desktop"/>
        <package name="kmail5"/>
        <package name="MozillaFirefox"/>
        <package name="kdepim"/>
        <package name="akregator5"/>
        <package name="skanlite"/>
        <package name="libreoffice-draw"/>
        <package name="gwenview5"/>
        <package name="gimp"/>
        <package name="ksudoku"/>
        <package name="kmines"/>
        <package name="kpat"/>
        <package name="kreversi"/>
        <package name="kmahjongg"/>
        <package name="libqt5-qttools"/>
        <package name="libqt5-linguist"/>
        <package name="patterns-openSUSE-imaging_opt"/>
        <package name="patterns-openSUSE-imaging"/>
        <package name="patterns-openSUSE-yast2_basis"/>
        <package name="patterns-openSUSE-x11_opt"/>
        <package name="patterns-openSUSE-sw_management_kde"/>
        <package name="patterns-openSUSE-sw_management"/>
        <package name="patterns-openSUSE-office_opt"/>
        <package name="patterns-openSUSE-office"/>
        <package name="patterns-openSUSE-non_oss_opt"/>
        <package name="patterns-openSUSE-non_oss"/>
        <package name="patterns-openSUSE-multimedia_opt"/>
        <package name="patterns-openSUSE-multimedia"/>
        <package name="patterns-openSUSE-kde_yast"/>
        <package name="patterns-openSUSE-kde_utilities_opt"/>
        <package name="patterns-openSUSE-kde_utilities"/>
        <package name="patterns-openSUSE-kde_plasma"/>
        <package name="patterns-openSUSE-kde_office"/>
        <package name="patterns-openSUSE-kde_multimedia"/>
        <package name="patterns-openSUSE-kde_internet"/>
        <package name="patterns-openSUSE-kde_imaging"/>
        <package name="patterns-openSUSE-kde_games"/>
        <package name="patterns-openSUSE-games"/>
        <package name="patterns-openSUSE-fonts_opt"/>
        <package name="patterns-openSUSE-fonts"/>
        <package name="patterns-openSUSE-enhanced_base_opt"/>
        <package name="patterns-openSUSE-enhanced_base"/>
        <package name="patterns-openSUSE-apparmor_opt"/>
        <package name="patterns-openSUSE-apparmor"/>
        <package name="patterns-openSUSE-x11"/>
        <package name="grub"/>
        <package name="kdebase4-openSUSE"/>
        <package name="patterns-openSUSE-kde"/>
        <package name="sddm"/>
        <package name="konsole"/>
        <package name="libyui-qt-pkg7"/>
        <package name="kwin"/>
        <package name="soprano-backend-virtuoso"/>
        <package name="yast2-control-center-qt"/>
        <package name="kdebase4-session"/>
        <package name="sax3"/>
        <package name="x11-tools"/>
        <package name="xorg-x11"/>
        <package name="xorg-x11-driver-input"/>
        <package name="xorg-x11-driver-video"/>
        <package name="xorg-x11-fonts"/>
        <package name="grub2-branding-openSUSE"/>
        <package name="gfxboot-branding-openSUSE"/>
        <package name="yast2-x11"/>
        <package name="SuSEfirewall2"/>
        <package name="less"/>
        <package name="yast2-firstboot"/>
        <package name="e2fsprogs"/>
        <package name="branding-openSUSE"/>
        <package name="patterns-openSUSE-base"/>
        <package name="grub2"/>
        <package name="iputils"/>
        <package name="kernel-default"/>
        <package name="plymouth"/>
        <package name="syslog-ng"/>
        <package name="vim"/>
        <package name="zypper"/>
        <package name="timezone"/>
        <package name="gsettings-backend-dconf"/>
        <package name="glibc"/>
        <package name="glibc-locale"/>
        <package name="yast2-live-installer"/>
        <package name="yast2-users"/>
        <package name="btrfsprogs"/>
        <archive name="plymouth.tar" bootinclude="true"/>
        <package name="gfxboot-devel" bootinclude="true"/>
        <archive name="sddm.tar"/>
      </packages>
      <packages type="bootstrap">
        <package name="filesystem"/>
        <package name="glibc-locale"/>
        <package name="module-init-tools"/>
      </packages>
    </image>
  </config>
  <extra_config name="Linux_Kamarada_42.2_KDE">
    <appliance_id>1703424</appliance_id>
    <arch>x86_64</arch>
    <version>0.0.27</version>
    <logo>02/d3230a1e4c9773cc12fa74982a16d2</logo>
    <background>ee/74452ca646d75e5516fe5db8836e76</background>
    <base_system>Leap_42.1</base_system>
    <image_type>iso</image_type>
    <time_zone>UTC</time_zone>
    <region>Global</region>
    <default_runlevel>5</default_runlevel>
    <install_recommended>false</install_recommended>
    <xen_host>false</xen_host>
    <exclude_docs>false</exclude_docs>
    <disable_branding>false</disable_branding>
    <template>openSUSE Leap 42.1, KDE 4 desktop</template>
    <locale>
      <language>en_US.UTF-8</language>
      <keytable>us.map.gz</keytable>
    </locale>
    <estimated_size>3940</estimated_size>
    <size_offset>0</size_offset>
    <non_interactive/>
    <oem_disk_size>16G</oem_disk_size>
    <check_supportability>false</check_supportability>
    <repository type="yast2">
      <source path="http://download.opensuse.org/distribution/leap/42.2/repo/oss/" internal="false"/>
      <name>openSUSE Leap 42.2 OSS</name>
    </repository>
    <repository type="rpm-md">
      <source path="http://download.opensuse.org/update/leap/42.2/oss/" internal="false"/>
      <name>leap 42.2 updates</name>
    </repository>
    <network config="network_manager">
    </network>
    <startup_programs>
    </startup_programs>
    <overlay_files remove="">
      <file name="license.tar.gz" path="/" owner="root" group="root" perms="644" type="archive" md5="79d0b114e2fa7b2dd6f86ba9f5a5814a" extract_archive="false"/>
      <file name="live-installer.desktop" path="/usr/share/applications/" owner="root" group="root" perms="644" type="file" md5="6c845a2b2729e0a67a9d22f215658913"/>
      <file name="start-install.sh" path="/usr/bin/" owner="root" group="root" perms="755" type="file" md5="565f9f0de504b63cf3833dba57b162cc"/>
    </overlay_files>
    <firewall>
      <firewall_enabled>yes</firewall_enabled>
      <firewall_ssh>closed</firewall_ssh>
      <firewall_http>closed</firewall_http>
      <firewall_webyast>closed</firewall_webyast>
    </firewall>
    <webyast enabled="false" version="">
    </webyast>
    <x_keyboard model="microsoftpro" layout="us" variant="" keycode="xfree86" LA="" RA="" SL="" RC="" OPT=""/>
    <build_script>
      <![CDATA[#!/bin/bash -e
#
# This script is executed at the end of appliance creation.  Here you can do
# one-time actions to modify your appliance before it is ever used, like
# removing files and directories to make it smaller, creating symlinks,
# generating indexes, etc.
#
# The 'kiwi_type' variable will contain the format of the appliance
# (oem = disk image, vmx = VMware, iso = CD/DVD, xen = Xen).
#

# read in some variables
. /studio/profile

# read in KIWI utility functions
. /.kconfig

#======================================
# /etc/sudoers hack to fix #297695
# (Installation Live DVD: no need to ask for password of root)
# https://bugzilla.novell.com/show_bug.cgi?id=297695
#--------------------------------------
sed -i -e "s/ALL ALL=(ALL) ALL/ALL ALL=(ALL) NOPASSWD: ALL/" /etc/sudoers
chmod 0440 /etc/sudoers

# Create LiveDVD user linux
/usr/sbin/useradd -m -u 999 linux -c "LiveDVD User" -p ""

# delete passwords
passwd -d root
passwd -d linux
# empty password is ok
pam-config -a --nullok

# bug 544314, we only want to disable the bit in common-auth-pc
# https://bugzilla.novell.com/show_bug.cgi?id=544314
sed -i -e 's,^\(.*pam_gnome_keyring.so.*\),#\1,'  /etc/pam.d/common-auth-pc

# Automatically log in user linux
baseUpdateSysConfig /etc/sysconfig/displaymanager DISPLAYMANAGER_AUTOLOGIN linux

# Official repositories
# (as found in http://download.opensuse.org/distribution/leap/42.2/repo/oss/control.xml)

rm /etc/zypp/repos.d/*.repo
zypper addrepo -f -K -n "openSUSE-Leap-42.2-Update" http://download.opensuse.org/update/leap/42.2/oss/ repo-update
zypper addrepo -d -K -n "openSUSE-Leap-42.2-Update-Non-Oss" http://download.opensuse.org/update/leap/42.2/non-oss/ repo-update-non-oss
zypper addrepo -f -K -n "openSUSE-Leap-42.2-Oss" http://download.opensuse.org/distribution/leap/42.2/repo/oss/ repo-oss
zypper addrepo -d -K -n "openSUSE-Leap-42.2-Non-Oss" http://download.opensuse.org/distribution/leap/42.2/repo/non-oss/ repo-non-oss
zypper addrepo -d -K -n "openSUSE-Leap-42.2-Debug" http://download.opensuse.org/debug/distribution/leap/42.2/repo/oss/ repo-debug
zypper addrepo -d -K -n "openSUSE-Leap-42.2-Debug-Non-Oss" http://download.opensuse.org/debug/distribution/leap/42.2/repo/non-oss/ repo-debug-non-oss
zypper addrepo -d -K -n "openSUSE-Leap-42.2-Update-Debug" http://download.opensuse.org/debug/update/leap/42.2/oss repo-debug-update
zypper addrepo -d -K -n "openSUSE-Leap-42.2-Update-Debug-Non-Oss" http://download.opensuse.org/debug/update/leap/42.2/non-oss/ repo-debug-update-non-oss
zypper addrepo -d -K -n "openSUSE-Leap-42.2-Source" http://download.opensuse.org/source/distribution/leap/42.2/repo/oss/ repo-source
zypper addrepo -d -K -n "openSUSE-Leap-42.2-Source-Non-Oss" http://download.opensuse.org/source/distribution/leap/42.2/repo/non-oss/ repo-source-non-oss

# bug 989897, avoid creating desktop directory on KDE so that the default items are added on first login
cp /usr/share/applications/live-installer.desktop /usr/share/kio_desktop/DesktopLinks/
# Set the application as being "trusted"
chmod a+x /usr/share/kio_desktop/DesktopLinks/live-installer.desktop

# openSUSE Bug 984330 overlayfs requires AppArmor attach_disconnected flag
# https://bugzilla.opensuse.org/show_bug.cgi?id=984330

# Linux Kamarada issue #1 unable to ping
# https://github.com/kamarada/kiwi-config-Kamarada/issues/1
sed -i -e 's/\/{usr\/,}bin\/ping {/\/{usr\/,}bin\/ping (attach_disconnected) {/g' /etc/apparmor.d/bin.ping]]>
    </build_script>
    <enable_root_firstboot>false</enable_root_firstboot>
    <window_manager>kde4</window_manager>
    <display_manager>sddm</display_manager>
  </extra_config>
</manifest>
